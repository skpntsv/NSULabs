# Лабораторная работа CrackHash

## Описание

CrackHash - распределенная система для взлома MD5 хешей методом перебора (brute-force). Система состоит из двух основных компонентов:

1. **Менеджер (Manager)** - центральный компонент, который принимает запросы от пользователей, распределяет задачи между рабочими узлами и собирает результаты.
2. **Воркер (Worker)** - вычислительный узел, который выполняет перебор значений и поиск соответствия хешу.

### Принцип работы системы:

1. Клиент отправляет запрос менеджеру с MD5 хешем и максимальной длиной слова
2. Менеджер создает задачи для воркеров, разделяя пространство поиска
3. Воркеры выполняют перебор и отправляют результаты менеджеру
4. Менеджер аккумулирует результаты и предоставляет их клиенту

## Установка и запуск

### Требования
- Docker Compose

### Запуск системы

```bash
docker-compose up --build -d
```

По умолчанию система запускает 3 воркера и 1 менеджер. Менеджер доступен по адресу: `http://localhost:8080`

## Конфигурация

Доступна конфигурация в `docker-compose.yml` файле:
* Изменение количество воркеров;
* Изменение url и портов.

### Менеджер

Менеджер настраивается через переменные окружения:

- `WORKER_URLS` - список URL воркеров, разделенных запятыми (пример: `http://worker1:8081,http://worker2:8081`)
- `PORT` - порт, на котором запускается менеджер (по умолчанию: `8080`)

### Воркер

Воркер настраивается через переменные окружения:

- `MANAGER_URL` - URL менеджера (по умолчанию: `http://manager:8080`)
- `PORT` - порт, на котором запускается воркер (по умолчанию: `8081`)

## API

### Публичное API менеджера (для клиентов)

#### Запрос на взлом хеша

```js
POST url/api/hash/crack
```

**Request body:**
```json
{
    "hash": "d077f244def8a70e5ea758bd8352fcd8",
    "maxLength": 4
}
```

**Response:**
```json
{
    "requestId": "aec7b2fb-bc25-4586-a05d-c21bb7b23358"
}
```

#### Проверка статуса запроса

```js
GET url/api/hash/status?requestId=aec7b2fb-bc25-4586-a05d-c21bb7b23358
```

**Response (в процессе):**
```json
{
    "status": "IN_PROGRESS",
    "data": null,
    "progressPct": 45.7
}
```

**Response (готов):**
```json
{
    "status": "READY",
    "data": ["abcd"],
    "progressPct": 100
}
```

### Внутреннее API (для взаимодействия компонентов)

#### Менеджер → Воркер (отправка задачи)

```js
POST /internal/api/worker/hash/crack/task
```

**Request body:**
```json
{
    "requestId": "730a04e6-4de9-41f9-9d5b-53b88b17afac",
    "partNumber": 0,
    "partCount": 3,
    "hash": "e2fc714c4727ee9395f324cd2e7f331f",
    "maxLength": 4
}
```

#### Воркер → Менеджер (отправка результатов)

```js
POST /internal/api/manager/hash/crack/request
```

**Request body:**
```json
{
    "requestId": "730a04e6-4de9-41f9-9d5b-53b88b17afac",
    "words": ["abcd"],
    "partNumber": 0
}
```

#### Менеджер → Воркер (запрос прогресса)

```js
GET /internal/api/worker/hash/crack/progress?requestId=730a04e6-4de9-41f9-9d5b-53b88b17afac
```

**Response:**
```json
{
    "requestId": "730a04e6-4de9-41f9-9d5b-53b88b17afac",
    "partNumber": 0,
    "progressPct": 67.5
}
```

## Статусы запроса

- `NEW` - запрос создан
- `IN_PROGRESS` - запрос обрабатывается
- `PARTIAL_READY` - получены частичные результаты
- `READY` - запрос выполнен успешно
- `ERROR` - ошибка при выполнении запроса